# AstroBot

AstroBot — Telegram-бот для создания и управления событиями с помощью текста и голосовых сообщений.  
Бот умеет распознавать естественный язык, создавать события в Google Calendar, формировать удобные карточки встреч и анализировать благоприятность времени на основе астрологического контекста.

## Основные возможности

### Голосовое создание событий
Пользователь может отправить голосовое сообщение. Бот распознает речь и автоматически извлекает время, дату и название события.

### Команда ++event
AstroBot поддерживает ручное создание события в формате:

    ++event пятница 14:00-16:00 презентация клиенту --remind 1h,15m

Бот корректно обрабатывает относительные и абсолютные формулировки:  
"завтра в 11", "через 2 часа", "следующий понедельник", "15:00-16:00" и другие.

### Понимание естественного языка
Бот анализирует текст запроса, извлекает структуру события, даты, диапазоны времени и длительности.

### Астрологическая оценка времени
AstroBot использует локальный векторный индекс (FAISS) для поиска релевантных астрологических текстов.  
Затем, на основе найденного контекста, бот запрашивает LLM для формирования краткого астрологического совета о благоприятности выбранного времени.

### Напоминания
Пользователь может указать напоминания вручную:

    --remind 15m,1h,2h

Или использовать настройки по умолчанию.

### Интеграция с Google Calendar
Каждое созданное событие автоматически добавляется в Google Calendar пользователя.

### Карточки событий
После создания события бот формирует информативную карточку события и закрепляет её в чате.

## Политика обработки данных

Используя AstroBot, пользователь соглашается, что текстовые и голосовые сообщения могут быть переданы сторонним сервисам, которые используются для обеспечения работы бота:

- Deepgram — обработка голосовых сообщений (автоматическое распознавание речи).  
- OpenAI / OpenRouter — обработка текста, анализ дат, генерация астрологических рекомендаций.  
- Google Calendar API — создание, обновление и управление событиями в календаре пользователя.

AstroBot не хранит голосовые сообщения и удаляет их после обработки.  
Переданные данные используются исключительно для функциональных задач бота и не передаются третьим лицам, кроме перечисленных сервисов интеграции.

## Installation

1. Создаем python environment
```bash
python -m venv ~/venv/llm_project
source ~/venv/llm_project/bin/activate
```

2. Создаем файл .env
Скопируйте файл:
```bash
cp example.env .env
```

3. Получаем DEEPGRAM_API_KEY
Ключ можно получить в личном кабинете Deepgram:
1. Перейти [сюда](https://console.deepgram.com).
2. Зарегистрироваться (если аккаунта нет).
3. Открыть раздел **API Keys**.
4. Нажать **Create API Key**.
5. Скопировать значение ключа и вставить в переменную `DEEPGRAM_API_KEY` в файле `.env`.

4. Авторизуем Telegram
```bash
bash scripts/auth/setup_auth.sh
```

5. Авторизуем Google Calendar
```bash
bash scripts/calendar/setup_auth.sh
```

6. Запускаем Docker
```bash
docker-compose up -d
```
